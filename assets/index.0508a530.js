var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,i=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o,l=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&i(e,a,t[a]);if(o)for(var a of o(t))s.call(t,a)&&i(e,a,t[a]);return e},r=(e,o)=>t(e,a(o));import{_ as d,a as u,b as g,c,d as m,e as p,f,g as I,h,i as _,j as C,k as L,l as v,m as D,n as U,o as b,p as A,q as S,r as O,s as E,t as k,u as T,v as R,w,x as y,y as M,z as G,A as x,B as P,C as N,D as V,E as $,F as j,G as z,H as F,I as B,J as H,K as X,L as J,M as Y,N as W,O as q,P as K,Q,R as Z,S as ee,T as te,U as ae,V as oe,W as ne,X as se,Y as ie,Z as le}from"./vendor.04273fd9.js";const re={state:{name:"dirImageListModule",dirImageList:(()=>{const e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):[]})()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},a){const o=e.dirImageList.find((e=>e.dir===a.dir));o&&(o.imageList.push(a),t("DIR_IMAGE_LIST_PERSIST"))},DIR_IMAGE_LIST_ADD_IMAGE_LIST({state:e,dispatch:t},a){const o=e.dirImageList.find((e=>e.dir===a.dir));o?o.imageList=a.imageList:e.dirImageList.unshift(a),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},a){if(!e.dirImageList.some((e=>e.dir===a))){const o={dir:a,imageList:[]};"/"===a?e.dirImageList.unshift(o):e.dirImageList.push(o),t("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},a){if(e.dirImageList.some((e=>e.dir===a))){const o=e.dirImageList.findIndex((e=>e.dir===a));e.dirImageList.splice(o,1),t("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},a){if(e.dirImageList.length>0){const o=e.dirImageList.find((e=>e.dir===a.dir));if(o){const e=o.imageList.findIndex((e=>e.uuid===a.uuid));-1!==e&&(o.imageList.splice(e,1),0===o.imageList.length&&(t("DIR_IMAGE_LIST_REMOVE_DIR",o.dir),t("USER_CONFIG_INFO_REMOVE_DIR",o.dir)),t("DIR_IMAGE_LIST_PERSIST"))}}},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem("PICX_MANAGEMENT",JSON.stringify(e.dirImageList))},DIR_IMAGE_LOGOUT({state:e}){e.dirImageList=[],localStorage.removeItem("PICX_MANAGEMENT")}},getters:{getDirImageList:e=>e.dirImageList}},de={state:{curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0},actions:{TO_UPLOAD_IMAGE_LIST_ADD({state:e},t){e.list.unshift(t)},TO_UPLOAD_IMAGE_SET_CURRENT({state:e},{uuid:t,base64Url:a}){e.curImgUuid=t,e.curImgBase64Url=a},TO_UPLOAD_IMAGE_UPLOADED({state:e}){e.uploadedNumber+=1},TO_UPLOAD_IMAGE_LIST_REMOVE({state:e},t){if(e.list.length>0){const a=e.list.findIndex((e=>e.uuid===t));if(-1!==a&&e.list.splice(a,1),0===e.list.length)e.curImgBase64Url="",e.uploadedNumber=0;else if(e.curImgUuid===t){const t=e.list[0];e.curImgBase64Url=t.imgData.base64Url,e.curImgUuid=t.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL({state:e}){if(e.list.length>0){const t=e.list.filter((e=>100!==e.uploadStatus.progress));t.length>0&&(e.list=t,e.uploadedNumber=0,e.curImgBase64Url=t[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL({state:e}){e.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST({state:e}){e.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER({state:e}){e.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT({state:e}){e.curImgBase64Url="",e.list=[],e.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImage:e=>e}},ue={state:{uploadedImageList:(()=>{const e=sessionStorage.getItem("PICX_UPLOADED");return e?JSON.parse(e):[]})()},mutations:{},actions:{UPLOADED_LIST_ADD({state:e,dispatch:t},a){e.uploadedImageList.unshift(a),t("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE({state:e,dispatch:t},a){if(e.uploadedImageList.length>0){const o=e.uploadedImageList.findIndex((e=>e.uuid===a.uuid));-1!==o&&(e.uploadedImageList.splice(o,1),t("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST({state:e}){sessionStorage.setItem("PICX_UPLOADED",JSON.stringify(e.uploadedImageList))},UPLOADED_LIST_LOGOUT({state:e}){e.uploadedImageList=[],sessionStorage.removeItem("PICX_UPLOADED")}},getters:{getUploadedImageList:e=>e.uploadedImageList}},ge=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},ce=e=>{for(let t in e)switch(ge(e[t])){case"object":ce(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1}},me=k({modules:{dirImageListModule:re,toUploadImageModule:de,uploadedImageListModule:ue,userConfigInfoModule:{state:{userConfigInfo:(()=>{const e=localStorage.getItem("PICX_CONFIG");return e?JSON.parse(e):{token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepos:"",reposList:[],selectedBranch:"",dirMode:"",selectedDir:"",dirList:[],loggingStatus:!1}})()},actions:{SET_USER_CONFIG_INFO({state:e},t){for(const a in t)e.userConfigInfo.hasOwnProperty(a)&&(e.userConfigInfo[a]=t[a])},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},a){e.userConfigInfo.dirList.some((e=>e.value===a))||(e.userConfigInfo.dirList.push({label:a,value:a}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},a){const{dirList:o}=e.userConfigInfo;if(o.some((e=>e.value===a))){const e=o.findIndex((e=>e.value===a));o.splice(e,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){e.userConfigInfo.selectedDir=e.userConfigInfo.selectedDir.replace(/\s+/g,"-"),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){ce(e.userConfigInfo),localStorage.removeItem("PICX_CONFIG")}},getters:{getUserLoggingStatus:e=>e.userConfigInfo.loggingStatus,getUserConfigInfo:e=>e.userConfigInfo}},imageViewerModule:{state:{imageViewer:{url:"",isShow:!1}},mutations:{IMAGE_VIEWER(e,{url:t,isShow:a}){e.imageViewer.url=t,e.imageViewer.isShow=a},IMAGE_VIEWER_LOGOUT(e){e.imageViewer.isShow=!1,e.imageViewer.url=""}},actions:{},getters:{getImageViewer:e=>e.imageViewer}},uploadAreaActiveModule:{state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},actions:{},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},uploadSettingsModule:{state:{uploadSettings:{isSetMaxSize:!1,compressSize:200}},mutations:{UPLOAD_SETTINGS_LOGOUT(e){e.uploadSettings.isSetMaxSize=!1,e.uploadSettings.compressSize=200}},actions:{},getters:{getUploadSettings:e=>e.uploadSettings}}},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){e("DIR_IMAGE_LOGOUT"),e("TO_UPLOAD_IMAGE_LOGOUT"),e("UPLOADED_LIST_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),t("IMAGE_VIEWER_LOGOUT"),t("UPLOAD_AREA_ACTIVE_LOGOUT"),t("UPLOAD_SETTINGS_LOGOUT")}},getters:{}}),pe=Symbol("vue-store");function fe(){return T(pe)}var Ie,he;(he=Ie||(Ie={})).autoDir="autoDir",he.newDir="newDir",he.rootDir="rootDir",he.reposDir="reposDir";const _e=R.create({baseURL:"https://api.github.com",timeout:3e5});_e.interceptors.request.use((e=>{const t=window.localStorage.getItem("accessToken");return t&&(e.headers.common.Authorization=t),e}),(e=>Promise.reject(e))),_e.interceptors.response.use((e=>e),(e=>{if(e.response&&e.response.data){const t=e.response.status,a=e.response.data.message;w.error(`Code: ${t}, Message: ${a}`),console.error("[PicX Error]",e.response)}else w.error(`${e}`);return e.response}));class Ce{static zerofill(e){return e<10?"0"+e:e}static getYyyyMmDd(e=Date.now()){const t=new Date(e),a=t.getFullYear(),o=t.getMonth()+1,n=t.getDate();return`${a}${this.zerofill(o)}${this.zerofill(n)}`}static formatTimestamp(e=Date.now()){const t=new Date(e);let a=t.getFullYear(),o=t.getMonth()+1,n=t.getDate(),s=t.getHours(),i=t.getMinutes(),l=t.getSeconds();return`${a}-${this.zerofill(o)}-${this.zerofill(n)} ${this.zerofill(s)}:${this.zerofill(i)}:${this.zerofill(l)}`}}var Le=y({name:"Config",setup(){const e=M(),t=fe(),a=G({userConfigInfo:x((()=>t.getters.getUserConfigInfo)).value,loggingStatus:x((()=>t.getters.getUserConfigInfo)).value,loading:!1,dirLoading:!1,getUserInfo(){this.userConfigInfo.token?(this.loading=!0,_e.get("/user",{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{e&&200===e.status?(this.saveUserInfo(e),this.getReposList(e.data.repos_url)):this.loading=!1}))):w.warning("Token 不能为空！")},saveUserInfo(e){this.userConfigInfo.loggingStatus=!0,this.userConfigInfo.owner=e.data.login,this.userConfigInfo.name=e.data.name,this.userConfigInfo.email=e.data.email,this.userConfigInfo.avatarUrl=e.data.avatar_url,this.persistUserConfigInfo()},getReposList(e){_e.get(e,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(200===e.status&&e.data.length>0){this.userConfigInfo.reposList=[];for(const t of e.data)t.fork||this.userConfigInfo.reposList.push({value:t.name,label:t.name,desc:t.description});this.loading=!1,this.persistUserConfigInfo()}}))},innerSelectRepos(e){a.getBranchList(e),a.persistUserConfigInfo()},getBranchList(e){this.dirLoading=!0,_e.get(`/repos/${this.userConfigInfo.owner}/${e}/branches`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(t&&200===t.status){this.dirLoading=!1;const a="master",o="main";t.data.length>0?(t.data.some((e=>e.name===a))?this.userConfigInfo.selectedBranch=a:t.data.some((e=>e.name===o))&&(this.userConfigInfo.selectedBranch=o),this.getDirList(e)):(this.userConfigInfo.selectedBranch=a,this.userConfigInfo.dirMode=Ie.newDir,this.userConfigInfo.selectedDir="",this.userConfigInfo.dirList=[])}}))},getDirList(e){this.dirLoading=!0,_e.get(`/repos/${this.userConfigInfo.owner}/${e}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(e&&200===e.status&&e.data.length>0){this.userConfigInfo.dirList=[{value:"/",label:"/"}];for(const t of e.data)"dir"===t.type&&this.userConfigInfo.dirList.push({value:t.name,label:t.name});this.persistUserConfigInfo()}this.dirLoading=!1}))},innerDirModeChange(e){switch(e){case Ie.rootDir:this.userConfigInfo.selectedDir="/";break;case Ie.autoDir:this.userConfigInfo.selectedDir=Ce.getYyyyMmDd();break;case Ie.newDir:case Ie.reposDir:this.userConfigInfo.selectedDir="";break;default:this.userConfigInfo.selectedDir="/"}this.persistUserConfigInfo()},persistUserConfigInfo(){t.dispatch("USER_CONFIG_INFO_PERSIST")},reset(){this.loading=!1,this.dirLoading=!1,t.dispatch("LOGOUT")},innerGoUpload(){const{selectedDir:t,dirMode:a}=this.userConfigInfo;let o="目录不能为空！";if(""===t){switch(a){case Ie.newDir:o="请在输入框输入一个新目录！";break;case Ie.reposDir:o=`请选择 ${this.userConfigInfo.selectedRepos} 仓库下的一个目录！`;break;default:o="请在输入框输入一个新目录！"}w.warning(o)}else e.push("/upload")}});return P((()=>a.loggingStatus),(e=>{e||(a.loading=!1,a.dirLoading=!1)})),r(l({},N(a)),{dirModeChange:e=>{a.innerDirModeChange(e)},selectRepos:e=>{a.innerSelectRepos(e)},goUpload:()=>{a.innerGoUpload()}})}});const ve=Q();V("data-v-11afc752");const De={class:"page-container config-page-container"},Ue=q(" 确认 Token "),be=q("新建目录"),Ae=q("根目录"),Se=q("自动目录"),Oe=q(" 重置 "),Ee=q("完成配置 ");$();const ke=ve(((e,t,a,o,n,s)=>{const i=j("el-input"),l=j("el-form-item"),r=j("el-button"),d=j("el-form"),u=j("el-option"),g=j("el-select"),c=j("el-radio"),m=j("el-tooltip"),p=j("el-radio-group"),f=z("loading");return F(),B("div",De,[H(d,{"label-width":"70px","label-position":"right",class:"config-form"},{default:ve((()=>[H(l,{label:"Token"},{default:ve((()=>[H(i,{modelValue:e.userConfigInfo.token,"onUpdate:modelValue":t[1]||(t[1]=t=>e.userConfigInfo.token=t),clearable:!0},null,8,["modelValue"])])),_:1}),H(l,{class:"operation"},{default:ve((()=>[H(r,{plain:"",size:"small",type:"primary",onClick:t[2]||(t[2]=t=>e.getUserInfo())},{default:ve((()=>[Ue])),_:1})])),_:1})])),_:1}),e.userConfigInfo.token?X((F(),B(d,{key:0,"label-width":"70px","label-position":"right","element-loading-text":"加载中..."},{default:ve((()=>[e.userConfigInfo.owner?(F(),B(l,{key:0,label:"用户名"},{default:ve((()=>[H(i,{modelValue:e.userConfigInfo.owner,"onUpdate:modelValue":t[3]||(t[3]=t=>e.userConfigInfo.owner=t),readonly:""},null,8,["modelValue"])])),_:1})):J("",!0),e.userConfigInfo.email?(F(),B(l,{key:1,label:"邮箱"},{default:ve((()=>[H(i,{modelValue:e.userConfigInfo.email,"onUpdate:modelValue":t[4]||(t[4]=t=>e.userConfigInfo.email=t),readonly:""},null,8,["modelValue"])])),_:1})):J("",!0),e.userConfigInfo.reposList.length?(F(),B(l,{key:2,label:"选择仓库"},{default:ve((()=>[H(g,{modelValue:e.userConfigInfo.selectedRepos,"onUpdate:modelValue":t[5]||(t[5]=t=>e.userConfigInfo.selectedRepos=t),filterable:"",style:{width:"100%"},placeholder:"请选择图床仓库...",onChange:e.selectRepos},{default:ve((()=>[(F(!0),B(Y,null,W(e.userConfigInfo.reposList,((e,t)=>(F(),B(u,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):J("",!0)])),_:1},512)),[[f,e.loading]]):J("",!0),e.userConfigInfo.selectedRepos?X((F(),B(d,{key:1,"label-width":"70px","label-position":"right","element-loading-text":"加载中..."},{default:ve((()=>[e.userConfigInfo.reposList.length&&e.userConfigInfo.selectedRepos?(F(),B(l,{key:0,label:"目录方式"},{default:ve((()=>[H(p,{modelValue:e.userConfigInfo.dirMode,"onUpdate:modelValue":t[6]||(t[6]=t=>e.userConfigInfo.dirMode=t),onChange:e.dirModeChange},{default:ve((()=>[H(m,{content:"手动输入一个新目录",placement:"top"},{default:ve((()=>[H(c,{label:"newDir"},{default:ve((()=>[be])),_:1})])),_:1}),H(m,{content:"图片存储在 "+e.userConfigInfo.selectedBranch+" 分支的根目录下",placement:"top"},{default:ve((()=>[H(c,{label:"rootDir"},{default:ve((()=>[Ae])),_:1})])),_:1},8,["content"]),H(m,{content:"根据日期自动创建格式 YYYYMMDD 的目录",placement:"top"},{default:ve((()=>[H(c,{label:"autoDir"},{default:ve((()=>[Se])),_:1})])),_:1}),e.userConfigInfo.dirList.length?(F(),B(m,{key:0,content:"选择 "+e.userConfigInfo.selectedRepos+" 仓库下的一个目录",placement:"top"},{default:ve((()=>[H(c,{label:"reposDir"},{default:ve((()=>[q("选择 "+K(e.userConfigInfo.selectedRepos)+" 仓库目录",1)])),_:1})])),_:1},8,["content"])):J("",!0)])),_:1},8,["modelValue","onChange"])])),_:1})):J("",!0),"autoDir"===e.userConfigInfo.dirMode?(F(),B(l,{key:1,label:"自动目录"},{default:ve((()=>[H(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[7]||(t[7]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):J("",!0),"rootDir"===e.userConfigInfo.dirMode?(F(),B(l,{key:2,label:"根目录"},{default:ve((()=>[H(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[8]||(t[8]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):J("",!0),"newDir"===e.userConfigInfo.dirMode?(F(),B(l,{key:3,label:"新建目录"},{default:ve((()=>[H(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[9]||(t[9]=t=>e.userConfigInfo.selectedDir=t),onInput:t[10]||(t[10]=t=>e.persistUserConfigInfo()),clearable:"",placeholder:"请输入新建的目录..."},null,8,["modelValue"])])),_:1})):J("",!0),e.userConfigInfo.dirList.length&&"reposDir"===e.userConfigInfo.dirMode?(F(),B(l,{key:4,label:"选择目录"},{default:ve((()=>[H(g,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[11]||(t[11]=t=>e.userConfigInfo.selectedDir=t),filterable:"",style:{width:"100%"},placeholder:"请选择目录...",onChange:e.persistUserConfigInfo},{default:ve((()=>[(F(!0),B(Y,null,W(e.userConfigInfo.dirList,(e=>(F(),B(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):J("",!0)])),_:1},512)),[[f,e.dirLoading]]):J("",!0),H(d,{"label-width":"70px"},{default:ve((()=>[H(l,{class:"operation"},{default:ve((()=>[e.userConfigInfo.owner?(F(),B(r,{key:0,plain:"",size:"small",onClick:t[12]||(t[12]=t=>e.reset())},{default:ve((()=>[Oe])),_:1})):J("",!0),e.userConfigInfo.selectedRepos?(F(),B(r,{key:1,plain:"",size:"small",type:"success",onClick:e.goUpload},{default:ve((()=>[Ee])),_:1},8,["onClick"])):J("",!0)])),_:1})])),_:1})])}));var Te,Re;Le.render=ke,Le.__scopeId="data-v-11afc752",(Re=Te||(Te={})).gh="gh",Re.md_gh="md_gh",Re.cdn="cdn",Re.md_cdn="md_cdn";var we=y({name:"copy-external-link",props:{imgObj:{type:Object,default:()=>({})}},setup:e=>({copyExternalLink:function(t){let a="",o="";switch(t){case Te.gh:e.imgObj.is_transform_md?(a=e.imgObj.md_gh_url,o="Markdown 格式的 GitHub"):(a=e.imgObj.github_url,o="GitHub");break;case Te.cdn:e.imgObj.is_transform_md?(a=e.imgObj.md_cdn_url,o="Markdown 格式的 CDN"):(a=e.imgObj.cdn_url,o="CDN")}let n=document.querySelector(".temp-external-link");n||(n=document.createElement("textarea"),n.setAttribute("class","temp-external-link"),n.style.position="absolute",n.style.top="-99999px",n.style.left="-99999px",document.body.appendChild(n)),n.value=a,n.select(),document.execCommand("copy"),w.success(`${o} 外链复制成功！`)},transformMD:function(){e.imgObj.is_transform_md=!e.imgObj.is_transform_md},externalLinkType:Te})});const ye=Q();V("data-v-36636aee");const Me={class:"copy-external-link-box"};$();const Ge=ye(((e,t,a,o,n,s)=>{const i=j("el-tooltip");return F(),B("div",Me,[H(i,{content:e.imgObj.is_transform_md?"已转换 Markdown 格式":"转换 Markdown 格式",placement:"top"},{default:ye((()=>[H("span",{class:["btn-item transform-btn",{"is-transform":e.imgObj.is_transform_md}],onClick:t[1]||(t[1]=t=>e.transformMD())}," MD ",2)])),_:1},8,["content"]),H(i,{content:"点击复制 GitHub 外链",placement:"top"},{default:ye((()=>[H("span",{class:"btn-item copy-url",onClick:t[2]||(t[2]=t=>e.copyExternalLink(e.externalLinkType.gh))}," GitHub ")])),_:1}),H(i,{content:"点击复制 CDN 外链",placement:"top"},{default:ye((()=>[H("span",{class:"btn-item copy-url",onClick:t[3]||(t[3]=t=>e.copyExternalLink(e.externalLinkType.cdn))}," CDN ")])),_:1})])}));we.render=Ge,we.__scopeId="data-v-36636aee";var xe=y({name:"ImageCard",components:{copyExternalLink:we},props:{imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1}},setup(){const e=fe(),t=G({isEnableDeleted:!0,userConfigInfo:x((()=>e.getters.getUserConfigInfo)).value,deleteImage(t){var a,o,n,s,i;t.deleting=!0,_e.delete(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(o=this.userConfigInfo)?void 0:o.selectedRepos}/contents/${t.path}`,{headers:{"Content-Type":"application/json",Authorization:`token ${null==(n=this.userConfigInfo)?void 0:n.token}`},data:{owner:null==(s=this.userConfigInfo)?void 0:s.owner,repo:null==(i=this.userConfigInfo)?void 0:i.selectedRepos,path:t.path,message:"delete pictures via PicX(https://github.com/XPoet/picx)",sha:t.sha}}).then((a=>{console.log("delete res: ",a),a&&200===a.status?(t.deleting=!1,w.success("删除成功！"),e.dispatch("UPLOADED_LIST_REMOVE",t),e.dispatch("DIR_IMAGE_LIST_REMOVE",t)):t.deleting=!1}))},imageView(t){e.commit("IMAGE_VIEWER",{isShow:!0,url:t.cdn_url})}});return l({},N(t))}});const Pe=Q();V("data-v-e60c1fc8");const Ne={class:"image-card","element-loading-text":"删除中...","element-loading-background":"rgba(0, 0, 0, 0.6)"},Ve={class:"image-box"},$e={class:"info-box"},je={class:"image-info"},ze={class:"filename"},Fe={class:"image-operation"},Be={class:"delete"};$();const He=Pe(((e,t,a,o,n,s)=>{const i=j("el-tooltip"),l=j("copyExternalLink"),r=z("loading");return X((F(),B("div",Ne,[H("div",Ve,[H("img",{src:e.imageObj.cdn_url,onClick:t[1]||(t[1]=t=>e.imageView(e.imageObj))},null,8,["src"])]),H("div",$e,[H("div",je,[H("div",ze,K(e.imageObj.name),1),H("div",Fe,[H("div",Be,[H(i,{content:"删除",placement:"top"},{default:Pe((()=>[H("i",{class:"el-icon-delete",onClick:t[2]||(t[2]=t=>e.deleteImage(e.imageObj))})])),_:1})]),H("div",null,[H(l,{"img-obj":e.imageObj},null,8,["img-obj"])])])])])],512)),[[r,e.imageObj.deleting]])}));xe.render=He,xe.__scopeId="data-v-e60c1fc8";const Xe=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Je=e=>{const t=e.lastIndexOf("."),a=e.substr(0,t),o=e.substr(t+1,e.length);return{name:a,hash:Xe(),suffix:o}},Ye=e=>{const t=e.indexOf(".");return e.substr(0,t)},We=e=>/(png|jpg|gif|jpeg|webp|svg\+xml)$/.test(e);var qe,Ke;(Ke=qe||(qe={})).waitUpload="waitUpload",Ke.uploading="uploading",Ke.uploaded="uploaded",Ke.allUploaded="allUploaded",Ke.uploadFail="uploadFail";const Qe=(e,t,a)=>{const o=`https://cdn.jsdelivr.net/gh/${a.owner}/${a.selectedRepos}@${a.selectedBranch}/${t.path}`,n=decodeURI(t.download_url);switch(e){case Te.gh:return n;case Te.md_gh:return`![${Ye(t.name)}](${n})`;case Te.cdn:return o;case Te.md_cdn:return`![${Ye(t.name)}](${o})`}};var Ze=y({name:"selected-info-bar",setup(){const e=fe(),t=G({userConfigInfo:x((()=>e.getters.getUserConfigInfo))});return l({},N(t))}});const et=Q();V("data-v-693c0476");const tt={key:0,class:"selected-info-bar-box"},at={class:"info-item"},ot=q(" 仓库："),nt={key:0,class:"info-item"},st=q(" 分支："),it={key:1,class:"info-item"},lt=q(" 目录：");$();const rt=et(((e,t,a,o,n,s)=>{const i=j("el-tag");return e.userConfigInfo.selectedRepos?(F(),B("div",tt,[H("span",at,[ot,H(i,{size:"mini"},{default:et((()=>[q(K(e.userConfigInfo.selectedRepos),1)])),_:1})]),e.userConfigInfo.selectedBranch?(F(),B("span",nt,[st,H(i,{size:"mini"},{default:et((()=>[q(K(e.userConfigInfo.selectedBranch),1)])),_:1})])):J("",!0),e.userConfigInfo.selectedDir?(F(),B("span",it,[lt,H(i,{size:"mini"},{default:et((()=>[q(K(e.userConfigInfo.selectedDir),1)])),_:1})])):J("",!0)])):J("",!0)}));Ze.render=rt,Ze.__scopeId="data-v-693c0476";var dt=y({name:"to-upload-image-card",components:{copyExternalLink:we,selectedInfoBar:Ze},props:{loadingAllImage:{type:Boolean,default:!1}},setup(){const e=fe(),t=G({userConfigInfo:x((()=>e.getters.getUserConfigInfo)).value,toUploadImage:x((()=>e.getters.getToUploadImage)),hashRename(e,t){t.filename.now=e?`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:`${t.filename.name}.${t.filename.suffix}`},rename(e,t){t.filename.name=e?t.filename.newName:t.filename.initName,t.filename.isHashRename?t.filename.now=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.now=`${t.filename.name}.${t.filename.suffix}`},getFileSize:e=>(e=>(e/1024).toFixed(2)+" KB")(e),formatLastModified:e=>Ce.formatTimestamp(e),async uploadImage_all(e){console.log("uploadImage_all123");const t=this.toUploadImage.uploadedNumber;return t>=this.toUploadImage.list.length?qe.uploaded:!0===await this.uploadImage_single(e,this.toUploadImage.list[t])?t<this.toUploadImage.list.length?(await this.uploadImage_all(e),qe.allUploaded):qe.uploaded:qe.uploadFail},uploadImage_single(t,a){const{token:o,selectedBranch:n,email:s,owner:i}=t;a.uploadStatus.uploading=!0;const l={message:"Upload by https://picx.ga/",branch:n,content:a.imgData.base64Content};return s&&(l.committer={name:i,email:s}),new Promise(((n,s)=>{_e.put(((e,t)=>{let a="";return"/"!==e.selectedDir&&(a=e.selectedDir+"/"),`/repos/${e.owner}/${e.selectedRepos}/contents/${a}${t}`})(t,a.filename.now),l,{headers:{"Content-Type":"application/json",Authorization:`token ${o}`}}).then((o=>{o&&201===o.status?(this.uploadedHandle(o,a,t),e.dispatch("TO_UPLOAD_IMAGE_UPLOADED",a.uuid),n(!0),w.success("上传成功！")):(a.uploadStatus.uploading=!1,n(!1),w.error("上传失败！"))})).catch((e=>{s(e)}))}))},uploadedHandle(t,a,o){a.uploadStatus.progress=100,a.uploadStatus.uploading=!1,a.externalLink.github=Qe(Te.gh,t.data.content,o),a.externalLink.cdn=Qe(Te.cdn,t.data.content,o),a.externalLink.markdown_gh=Qe(Te.md_gh,t.data.content,o),a.externalLink.markdown_cdn=Qe(Te.md_cdn,t.data.content,o);const n={uuid:a.uuid,dir:o.selectedDir,name:t.data.content.name,path:t.data.content.path,sha:t.data.content.sha,github_url:a.externalLink.github,cdn_url:a.externalLink.cdn,md_gh_url:a.externalLink.markdown_gh,md_cdn_url:a.externalLink.markdown_cdn,is_transform_md:!1,deleting:!1};a.uploadedImg=n,o.dirList.some((e=>e.value===n.dir))||(e.dispatch("USER_CONFIG_INFO_ADD_DIR",n.dir),e.dispatch("DIR_IMAGE_LIST_ADD_DIR",n.dir)),e.dispatch("UPLOADED_LIST_ADD",n),e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",n)},imageViewer(t){e.commit("IMAGE_VIEWER",{isShow:!0,url:t})}});return r(l({},N(t)),{removeToUploadImage:t=>{e.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",t.uuid)}})}});const ut={key:0,class:"to-upload-image-list-card"},gt={class:"header"},ct={key:0},mt={key:0,class:"body"},pt={class:"image-uploading-info-box"},ft={class:"left-image-box flex-center"},It={class:"right-operation-box"},ht={class:"top"},_t={class:"image-name"},Ct={class:"image-info"},Lt={class:"file-size item"},vt={class:"last-modified item"},Dt={key:0,class:"bottom rename-operation"},Ut={key:1,class:"bottom rename-operation"},bt={key:0,class:"el-icon-upload2"},At={key:1,class:"el-icon-loading"},St={key:2,class:"el-icon-check"},Ot=H("i",{class:"el-icon-delete"},null,-1);function Et(e,t,a){a&&a(e,t)}dt.render=function(e,t,a,o,n,s){const i=j("selectedInfoBar"),l=j("el-checkbox"),r=j("el-input"),d=j("copyExternalLink"),u=j("el-tooltip");return e.toUploadImage.list.length||e.userConfigInfo.selectedRepos?(F(),B("div",ut,[H("div",gt,[H("div",null,[H(i)]),H("div",null,[e.toUploadImage.list.length?(F(),B("span",ct,"已上传："+K(e.toUploadImage.uploadedNumber)+" / "+K(e.toUploadImage.list.length),1)):J("",!0)])]),e.toUploadImage.list.length?(F(),B("div",mt,[H("ul",pt,[(F(!0),B(Y,null,W(e.toUploadImage.list,((t,a)=>(F(),B("li",{class:["image-uploading-info-item",{disable:e.loadingAllImage}],key:a},[H("div",ft,[H("div",{class:"image-box",onClick:a=>e.imageViewer(t.imgData.base64Url)},[H("img",{src:t.imgData.base64Url},null,8,["src"])],8,["onClick"])]),H("div",It,[H("div",ht,[H("div",_t,K(t.filename.now),1),H("div",Ct,[H("span",Lt,K(e.getFileSize(t.fileInfo.size)),1),H("span",vt,K(e.formatLastModified(t.fileInfo.lastModified)),1)])]),t.uploadStatus.uploading||100===t.uploadStatus.progress?J("",!0):(F(),B("div",Dt,[H(l,{label:"哈希化",modelValue:t.filename.isHashRename,"onUpdate:modelValue":e=>t.filename.isHashRename=e,onChange:a=>e.hashRename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),H(l,{label:"重命名",modelValue:t.filename.isRename,"onUpdate:modelValue":e=>t.filename.isRename=e,onChange:a=>e.rename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),t.filename.isRename?(F(),B(r,{key:0,class:"rename-input",size:"mini",modelValue:t.filename.newName,"onUpdate:modelValue":e=>t.filename.newName=e,onInput:a=>e.rename(a,t),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):J("",!0)])),t.uploadStatus.uploading||100!==t.uploadStatus.progress?J("",!0):(F(),B("div",Ut,[H(d,{"img-obj":t.uploadedImg},null,8,["img-obj"])]))]),H("div",{class:["upload-status-box",{"wait-upload":!t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploading:t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploaded:!t.uploadStatus.uploading&&100===t.uploadStatus.progress}]},[t.uploadStatus.uploading||100===t.uploadStatus.progress?J("",!0):(F(),B("i",bt)),t.uploadStatus.uploading&&100!==t.uploadStatus.progress?(F(),B("i",At)):J("",!0),t.uploadStatus.uploading||100!==t.uploadStatus.progress?J("",!0):(F(),B("i",St))],2),100===t.uploadStatus.progress||t.uploadStatus.uploading?J("",!0):(F(),B("div",{key:0,class:"remove-to-upload-image",onClick:a=>e.removeToUploadImage(t)},[H(u,{effect:"dark",content:"移除",placement:"top"},{default:Z((()=>[Ot])),_:1})],8,["onClick"]))],2)))),128))])])):J("",!0)])):J("",!0)};const kt=(e,t,a=0)=>{if(!e)return;if(!We(e.type))return void w.error("该文件不是图片格式！");const o=new FileReader;o.readAsDataURL(e),o.onload=function(){const o=this.result;if(null===a||o.length<=a)return void Et(o,e,t);let n=new Image;n.src=o,n.onload=function(){Et(function(e,t,a){let o=document.createElement("canvas"),n=o.getContext("2d");const s=a,i=a/(e.width/e.height);o.width=s,o.height=i,n.fillStyle="#fff",n.fillRect(0,0,o.width,o.height),n.drawImage(e,0,0,s,i);const l=o.toDataURL(t,.75);return o=n=null,l}(n,e.type,a/1024),e,t),n=null}}};var Tt=y({name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(){const e=fe(),t=G({uploadAreaActive:x((()=>e.getters.getUploadAreaActive)),uploadSettings:x((()=>e.getters.getUploadSettings)).value,toUploadImage:x((()=>e.getters.getToUploadImage)),onSelect(t){e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const e of t.target.files)kt(e,((e,t)=>{this.getImage(e,t)}),this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null)},onDrop(t){const a=t.dataTransfer.files[0];kt(a,((e,t)=>{this.getImage(e,t)}),this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null),e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0)},async onPaste(e){const{url:t,file:a}=await((e,t=204800)=>{if(e.clipboardData&&e.clipboardData.items)return new Promise((a=>{for(let o=0,n=e.clipboardData.items.length;o<n;o++){const n=e.clipboardData.items[o];if("file"===n.kind){const e=n.getAsFile();kt(e,((e,t)=>{a({url:e,file:t})}),t)}}}))})(e,this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null);this.getImage(t,a)},getImage(t,a){this.toUploadImage.list.length===this.toUploadImage.uploadedNumber&&this.toUploadImage.list.length>0&&this.toUploadImage.uploadedNumber>0&&(e.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),e.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const o={uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",now:"",initName:"",newName:"images",isHashRename:!0,isRename:!1},externalLink:{github:"",cdn:"",markdown_gh:"",markdown_cdn:""}};o.imgData.base64Url=t,o.imgData.base64Content=t.split(",")[1];const{name:n,hash:s,suffix:i}=Je(a.name);o.uuid=s,o.fileInfo.size=a.size,o.fileInfo.lastModified=a.lastModified,o.filename.name=n,o.filename.hash=s,o.filename.suffix=i,o.filename.now=`${n}.${s}.${i}`,o.filename.initName=n,e.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(o))),e.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:s,base64Url:t})}});return l({},N(t))}});const Rt=Q();V("data-v-86198df2");const wt={key:0,for:"uploader",class:"active-upload"},yt={key:1,class:"tips active-upload"},Mt=H("i",{class:"icon el-icon-upload active-upload"},null,-1),Gt=H("div",{class:"text active-upload"},"拖拽、粘贴、或点击此处上传",-1);$();const xt=Rt(((e,t,a,o,n,s)=>{const i=z("loading");return X((F(),B("div",{class:["upload-area active-upload",{focus:e.uploadAreaActive}],onDragover:t[2]||(t[2]=ee((()=>{}),["prevent"])),onDrop:t[3]||(t[3]=ee(((...t)=>e.onDrop&&e.onDrop(...t)),["stop","prevent"])),onPaste:t[4]||(t[4]=(...t)=>e.onPaste&&e.onPaste(...t)),"element-loading-text":"图片上传中...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[e.uploadAreaActive?(F(),B("label",wt)):J("",!0),H("input",{id:"uploader",type:"file",onChange:t[1]||(t[1]=(...t)=>e.onSelect&&e.onSelect(...t)),multiple:"multiple"},null,32),e.toUploadImage.curImgBase64Url?J("",!0):(F(),B("div",yt,[Mt,Gt])),e.toUploadImage.curImgBase64Url?(F(),B("img",{key:2,class:"active-upload",src:e.toUploadImage.curImgBase64Url,alt:"Pictures to be uploaded"},null,8,["src"])):J("",!0)],34)),[[i,e.imageLoading]])}));Tt.render=xt,Tt.__scopeId="data-v-86198df2";var Pt=y({name:"Upload",components:{ImageCard:xe,ToUploadImageCard:dt,UploadArea:Tt},setup(){const e=fe(),t=M(),a=te(null),o=te(null),n=te(null),s=te(null),i=G({userConfigInfo:x((()=>e.getters.getUserConfigInfo)).value,logoutStatus:x((()=>e.getters.getUserLoggingStatus)),uploadedImageList:x((()=>e.getters.getUploadedImageList)),toUploadImage:x((()=>e.getters.getToUploadImage)),imageLoading:!1}),d=()=>{i.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_LOGOUT")};return P((()=>i.logoutStatus),(e=>{!e&&d()})),r(l({},N(i)),{GitHubExternalLinkInput:a,CDNExternalLinkInput:o,toUploadImageCardDom:n,uploadAreaDom:s,resetUploadInfo:d,uploadImage:()=>{const{token:a,selectedRepos:o,selectedDir:s}=i.userConfigInfo;return a?o?s?void(0!==i.toUploadImage.list.length?i.toUploadImage.list.length!==i.toUploadImage.uploadedNumber?(i.imageLoading=!0,n.value.uploadImage_all(i.userConfigInfo).then((t=>{switch(t){case qe.uploaded:case qe.allUploaded:i.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL");break;case qe.uploadFail:i.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL")}})).catch((e=>{console.error("upload error: ",e),i.imageLoading=!1}))):w.error("请选择要上传的图片！"):w.error("图片不能为空！")):(w.error("目录不能为空！"),void t.push("/config")):(w.error("请选择一个仓库！"),void t.push("/config")):(w.error("请先完成图床配置！"),void t.push("/config"))}})}});const Nt=Q();V("data-v-0cbd4bf0");const Vt={class:"upload-page-container"},$t={key:0,class:"upload-page-left page-container",style:{width:"30%"}},jt={class:"row-item"},zt={class:"content-box"},Ft={class:"row-item"},Bt={class:"content-box"},Ht={class:"row-item"},Xt={class:"content-box",style:{"text-align":"right"}},Jt=q("重置 "),Yt=q("上传 ");$();const Wt=Nt(((e,t,a,o,n,s)=>{const i=j("ImageCard"),l=j("UploadArea"),r=j("ToUploadImageCard"),d=j("el-button");return F(),B("div",Vt,[e.uploadedImageList.length?(F(),B("div",$t,[(F(!0),B(Y,null,W(e.uploadedImageList,((e,t)=>(F(),B("div",{class:"uploaded-item",key:t},[H(i,{"image-obj":e,"is-uploaded":!0},null,8,["image-obj"])])))),128))])):J("",!0),H("div",{class:"upload-page-right page-container",style:{width:e.uploadedImageList.length?"70%":"100%"}},[H("div",jt,[H("div",zt,[H(l,{"image-loading":e.imageLoading,ref:"uploadAreaDom"},null,8,["image-loading"])])]),H("div",Ft,[H("div",Bt,[H(r,{ref:"toUploadImageCardDom","loading-all-image":e.imageLoading},null,8,["loading-all-image"])])]),H("div",Ht,[H("div",Xt,[e.toUploadImage.list.length?(F(),B(d,{key:0,plain:"",size:"small",onClick:e.resetUploadInfo},{default:Nt((()=>[Jt])),_:1},8,["onClick"])):J("",!0),H(d,{type:"primary",plain:"",size:"small",onClick:e.uploadImage},{default:Nt((()=>[Yt])),_:1},8,["onClick"])])])],4)])}));Pt.render=Wt,Pt.__scopeId="data-v-0cbd4bf0";var qt=y({name:"Management",components:{ImageCard:xe,selectedInfoBar:Ze},setup(){const e=fe(),t=M(),a=G({userConfigInfo:x((()=>e.getters.getUserConfigInfo)).value,loggingStatus:x((()=>e.getters.getUserLoggingStatus)).value,dirImageList:x((()=>e.getters.getDirImageList)).value,currentDirImageList:[],loadingImageList:!1,initDirImageList(){if(!this.dirImageList.length)return void this.getReposContent();const{selectedDir:e}=this.userConfigInfo,t=this.dirImageList.find((t=>t.dir===e));t?t.imageList.length>0?this.currentDirImageList=t.imageList:this.getDirContent(e):this.isHasDir(e)&&this.getDirContent(e)},getReposContent(){var t,a;_e.get(`/repos/${null==(t=this.userConfigInfo)?void 0:t.owner}/${null==(a=this.userConfigInfo)?void 0:a.selectedRepos}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(console.log("res: ",t),t&&200===t.status&&t.data.length>0){e.dispatch("DIR_IMAGE_LIST_ADD_DIR","/");for(const a of t.data)"dir"===a.type?e.dispatch("DIR_IMAGE_LIST_ADD_DIR",a.name):"file"===a.type&&We(Je(a.name).suffix)&&e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",this.getImageObject(a,"/"));this.isHasDir(this.userConfigInfo.selectedDir)||(this.userConfigInfo.selectedDir="/"),this.dirChange(this.userConfigInfo.selectedDir)}}))},isHasDir(e){return this.userConfigInfo.dirList.some((t=>t.value===e))},getDirContent(t){var a,o;this.loadingImageList=!0;const n={dir:t,imageList:[]};_e.get(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(o=this.userConfigInfo)?void 0:o.selectedRepos}/contents/${t}`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((a=>{if(a&&200===a.status&&a.data.length>0){const o=[];for(const e of a.data)"file"===e.type&&We(Je(e.name).suffix)&&o.push(this.getImageObject(e,t));n.imageList=o,e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE_LIST",n),this.loadingImageList=!1}}))},getImageObject(e,t){return{uuid:Xe(),dir:t,name:e.name,path:e.path,sha:e.sha,github_url:Qe(Te.gh,e,this.userConfigInfo),cdn_url:Qe(Te.cdn,e,this.userConfigInfo),md_gh_url:Qe(Te.md_gh,e,this.userConfigInfo),md_cdn_url:Qe(Te.md_cdn,e,this.userConfigInfo),deleting:!1,is_transform_md:!1}},dirChange(e){const t=this.dirImageList.find((t=>t.dir===e));t&&t.imageList.length?this.currentDirImageList=t.imageList:this.getDirContent(e)}});return ae((()=>{a.initDirImageList()})),P((()=>a.loggingStatus),(e=>{!e&&t.push("/config")})),P((()=>a.dirImageList),(e=>{const t=e.find((e=>e.dir===a.userConfigInfo.selectedDir));t&&(a.currentDirImageList=t.imageList)}),{deep:!0}),r(l({},N(a)),{dirChange:function(e){a.dirChange(e)}})}});const Kt=Q();V("data-v-51a52ae0");const Qt={class:"page-container management-page-container"},Zt={class:"content-container"},ea={class:"top"},ta={class:"left"},aa={class:"right"},oa=q(" 切换目录： "),na={class:"bottom","element-loading-text":"加载中...","element-loading-background":"rgba(0, 0, 0, 0.6)"},sa={class:"image-list"};$();const ia=Kt(((e,t,a,o,n,s)=>{const i=j("selectedInfoBar"),l=j("el-option"),r=j("el-select"),d=j("ImageCard"),u=z("loading");return F(),B("div",Qt,[H("div",Zt,[H("div",ea,[H("div",ta,[H(i)]),H("div",aa,[oa,H(r,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[1]||(t[1]=t=>e.userConfigInfo.selectedDir=t),placeholder:"请选择",size:"mini",onChange:e.dirChange},{default:Kt((()=>[(F(!0),B(Y,null,W(e.userConfigInfo.dirList,((e,t)=>(F(),B(l,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])]),X(H("div",na,[H("ul",sa,[(F(!0),B(Y,null,W(e.currentDirImageList,((e,t)=>(F(),B("li",{class:"image-item",key:t,style:{width:"220px",height:"230px"}},[H(d,{"image-obj":e},null,8,["image-obj"])])))),128))])],512),[[u,e.loadingImageList]])])])}));qt.render=ia,qt.__scopeId="data-v-51a52ae0";const la=[{path:"/",name:"Index",redirect:{name:"Upload"}},{path:"/config",name:"Config",component:Le,meta:{title:"图床配置 | PicX 图床神器"}},{path:"/upload",name:"Upload",component:Pt,meta:{title:"图片上传 | PicX 图床神器"}},{path:"/management",name:"Management",component:qt,meta:{title:"图床管理 | PicX 图床神器"}}],ra=oe({history:ne(),routes:la});ra.beforeEach(((e,t,a)=>{e.meta.title&&(window.document.title=e.meta.title),a()}));var da=y({name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(){const e=te(null);return ae((()=>{const t=document.createElement("script");t.async=!0,t.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.value.appendChild(t)})),{siteCountDom:e}}});const ua={class:"site-count",ref:"siteCountDom"},ga={key:0,id:"busuanzi_value_site_uv"},ca={key:1,id:"busuanzi_value_site_pv"};da.render=function(e,t,a,o,n,s){return F(),B("span",ua,[e.isuv?(F(),B("span",ga)):J("",!0),e.isuv?J("",!0):(F(),B("span",ca))],512)};var ma=y({name:"Header",components:{siteCount:da},setup(){const e=M(),t=fe(),a=G({defaultUsername:"未登录",userConfigInfo:x((()=>t.state.userConfigInfoModule.userConfigInfo))});return r(l({},N(a)),{router:e,onUserInfoClick:()=>{a.userConfigInfo.loggingStatus||"/config"===e.currentRoute.value.path||e.push("/config")},handleCommand:a=>{switch(a){case"upload":e.push("/");break;case"config":e.push("/config");break;case"management":e.push("/management");break;case"logout":t.dispatch("LOGOUT"),e.push("/config")}}})}});const pa=Q();V("data-v-19bf21a2");const fa={class:"header"},Ia={class:"header-left"},ha=H("div",{class:"logo"},[H("img",{src:"./assets/logo.206d082d.png",alt:"PicX"})],-1),_a=H("div",{class:"title"},"小嘉自用",-1),Ca={class:"header-right"},La={class:"username"},va={key:0,class:"avatar"},Da=H("i",{class:"el-icon-user-solid"},null,-1),Ua={class:"el-dropdown-link"},ba={class:"avatar"},Aa=q(" 退出登录 ");$();const Sa=pa(((e,t,a,o,n,s)=>{var i,l;const r=j("el-dropdown-item"),d=j("el-dropdown-menu"),u=j("el-dropdown");return F(),B("header",fa,[H("div",Ia,[H("div",{class:"brand",onClick:t[1]||(t[1]=t=>e.router.push("/"))},[ha,_a])]),H("div",Ca,[H("div",{class:"user-info",onClick:t[2]||(t[2]=(...t)=>e.onUserInfoClick&&e.onUserInfoClick(...t))},[H("div",La,K(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),(null==(i=e.userConfigInfo)?void 0:i.avatarUrl)?J("",!0):(F(),B("div",va,[Da])),(null==(l=e.userConfigInfo)?void 0:l.avatarUrl)?(F(),B(u,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:pa((()=>[H(d,null,{default:pa((()=>[H(r,{command:"logout"},{default:pa((()=>[Aa])),_:1})])),_:1})])),default:pa((()=>{var t,a;return[H("span",Ua,[H("span",ba,[H("img",{src:null==(t=e.userConfigInfo)?void 0:t.avatarUrl,alt:null==(a=e.userConfigInfo)?void 0:a.owner},null,8,["src","alt"])])])]})),_:1},8,["onCommand"])):J("",!0)])])])}));ma.render=Sa,ma.__scopeId="data-v-19bf21a2";var Oa=y({name:"Nav",setup(){const e=M(),t=fe(),a=G({userConfigInfo:x((()=>t.getters.getUserConfigInfo)).value,navList:[{name:"图床配置",icon:"el-icon-edit-outline",isActive:!1,path:"/config"},{name:"上传图片",icon:"el-icon-upload2",isActive:!1,path:"/upload"},{name:"图床管理",icon:"el-icon-box",isActive:!1,path:"/management"}],navClick(t){const{path:a}=t;if("/management"===a){if(""===this.userConfigInfo.selectedRepos)return w.warning("请选择一个仓库！"),void e.push("/config");if(""===this.userConfigInfo.selectedDir)return w.warning("目录不能为空！"),void e.push("/config")}e.push(a)}}),o=e=>{a.navList.forEach((t=>{const a=t;return a.isActive=t.path===e,a}))};return P((()=>e.currentRoute.value),(e=>{o(e.path)})),ae((()=>{e.isReady().then((()=>{o(e.currentRoute.value.path)}))})),l({},N(a))}});const Ea=Q();V("data-v-530535bc");const ka={class:"nav"},Ta={class:"nav-list"},Ra={class:"nav-content"},wa={class:"nav-name"};$();const ya=Ea(((e,t,a,o,n,s)=>(F(),B("aside",ka,[H("ul",Ta,[(F(!0),B(Y,null,W(e.navList,((t,a)=>X((F(),B("li",{class:["nav-item flex-center",{active:t.isActive}],key:a,onClick:a=>e.navClick(t)},[H("div",Ra,[H("i",{class:["nav-icon",t.icon]},null,2),H("span",wa,K(t.name),1)])],10,["onClick"])),[[se,"/management"!==t.path||e.userConfigInfo.loggingStatus]]))),128))])]))));Oa.render=ya,Oa.__scopeId="data-v-530535bc",V("data-v-1beee754");const Ma={key:0,class:"image-box"};$();var Ga=y({expose:[],setup(e){const t=fe(),a=x((()=>t.getters.getImageViewer));return(e,t)=>(F(),B("div",{class:["image-viewer",{active:ie(a).isShow}],onClick:t[1]||(t[1]=e=>ie(a).isShow=!1)},[ie(a).url?(F(),B("div",Ma,[H("img",{class:"img",src:ie(a).url},null,8,["src"])])):J("",!0)],2))}});Ga.__scopeId="data-v-1beee754";var xa=y({name:"Main",components:{Header:ma,Nav:Oa,ImageViewer:Ga},setup(){const e=fe();return{changeUploadAreaActive:t=>{e.commit("CHANGE_UPLOAD_AREA_ACTIVE",t.target.classList.contains("active-upload"))}}}});const Pa=Q();V("data-v-38866358");const Na={class:"top"},Va={class:"bottom"},$a={class:"container"},ja={class:"left"},za={class:"right"},Fa={class:"content"};$();const Ba=Pa(((e,t,a,o,n,s)=>{const i=j("Header"),l=j("Nav"),r=j("router-view"),d=j("ImageViewer");return F(),B(Y,null,[H("main",{class:"main-container",onClick:t[1]||(t[1]=(...t)=>e.changeUploadAreaActive&&e.changeUploadAreaActive(...t))},[H("div",Na,[H(i)]),H("div",Va,[H("div",$a,[H("div",ja,[H(l)]),H("div",za,[H("div",Fa,[H(r)])])])])]),H(d)],64)}));xa.render=Ba,xa.__scopeId="data-v-38866358";var Ha=y({name:"App",components:{Main:xa}});Ha.render=function(e,t,a,o,n,s){const i=j("Main");return F(),B(i)};const Xa=le(Ha);var Ja;(Ja=Xa,Ja.use(d).use(u).use(g).use(c).use(m).use(p).use(f).use(I).use(h).use(_).use(C).use(L).use(v).use(D).use(U).use(b).use(A).use(S).use(O).use(E),Ja).use(ra).use(me,pe).mount("#app");
